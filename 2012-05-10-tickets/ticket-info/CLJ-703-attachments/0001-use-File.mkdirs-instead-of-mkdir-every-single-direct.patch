From e5b253d051c2c7d5e3a3a332d098fd7f9926eff9 Mon Sep 17 00:00:00 2001
From: Juergen Hoetzel <juergen@archlinux.org>
Date: Tue, 4 Jan 2011 14:03:18 +0100
Subject: [PATCH 1/2] use File.mkdirs instead of mkdir every single directory component

Signed-off-by: Juergen Hoetzel <juergen@archlinux.org>
---
 src/jvm/clojure/lang/Compiler.java |    8 +-------
 1 files changed, 1 insertions(+), 7 deletions(-)

diff --git a/src/jvm/clojure/lang/Compiler.java b/src/jvm/clojure/lang/Compiler.java
index d6202e6..68f29b9 100644
--- a/src/jvm/clojure/lang/Compiler.java
+++ b/src/jvm/clojure/lang/Compiler.java
@@ -6673,15 +6673,9 @@ static public void writeClassFile(String internalName, byte[] bytecode) throws E
 	String genPath = (String) COMPILE_PATH.deref();
 	if(genPath == null)
 		throw new Exception("*compile-path* not set");
-	String[] dirs = internalName.split("/");
-	String p = genPath;
-	for(int i = 0; i < dirs.length - 1; i++)
-		{
-		p += File.separator + dirs[i];
-		(new File(p)).mkdir();
-		}
 	String path = genPath + File.separator + internalName + ".class";
 	File cf = new File(path);
+	cf.getParentFile().mkdirs();
 	cf.createNewFile();
 	FileOutputStream cfs = new FileOutputStream(cf);
 	try
-- 
1.7.3.2

