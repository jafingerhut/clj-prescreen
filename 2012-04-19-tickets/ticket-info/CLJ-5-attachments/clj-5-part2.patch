From dc64116400efb7167b0a83f86ca93ad47c31964e Mon Sep 17 00:00:00 2001
From: gigasquid <cmeier@gigasquidsoftware.com>
Date: Thu, 15 Dec 2011 21:43:55 -0500
Subject: [PATCH] Add tests and fix formatting of errors [clj-5]

---
 src/clj/clojure/core.clj          |    2 +-
 test/clojure/test_clojure/let.clj |   10 +++++++++-
 2 files changed, 10 insertions(+), 2 deletions(-)

diff --git a/src/clj/clojure/core.clj b/src/clj/clojure/core.clj
index 0cd3375..2b244f6 100644
--- a/src/clj/clojure/core.clj
+++ b/src/clj/clojure/core.clj
@@ -3906,7 +3906,7 @@
     (instance? clojure.lang.Sequential val) :good
     :else ( if (instance? clojure.lang.IPersistentCollection  val)
             (throw (new Exception (str "let cannot destructure " (.getClass val) ". Try converting it to a seq.")))
-            (throw (new Exception (str "let cannot destructure " (.getClass val)))))))
+            (throw (new Exception (str "let cannot destructure " (.getClass val) "."))))))
 
 ;redefine let and loop  with destructuring
 (defn destructure [bindings]
diff --git a/test/clojure/test_clojure/let.clj b/test/clojure/test_clojure/let.clj
index 6ae0aaa..05dd0fa 100644
--- a/test/clojure/test_clojure/let.clj
+++ b/test/clojure/test_clojure/let.clj
@@ -47,4 +47,12 @@
  (testing "destructuring map to vector error"
     (is (fails-with-cause? java.lang.Exception
           #"let cannot destructure class clojure.lang.PersistentArrayMap. Try converting it to a seq."
-          (eval '(let [[x y] {}] x))))))
+          (eval '(let [[x y] {}] x)))))
+  (testing "destructuring set to vector error"
+    (is (fails-with-cause? java.lang.Exception
+          #"let cannot destructure class clojure.lang.PersistentHashSet. Try converting it to a seq."
+          (eval '(let [[x y] #{}] x)))))
+  (testing "destructuring long to vector error"
+    (is (fails-with-cause? java.lang.Exception
+          #"let cannot destructure class java.lang.Long."
+          (eval '(let [[x y] 1] x))))))
-- 
1.7.5.4

