From 654dfb27f0bf6035f5ae149288e08c7245e92b3c Mon Sep 17 00:00:00 2001
From: Meikel Brandmeyer <mb@kotka.de>
Date: Mon, 21 Mar 2011 19:26:42 +0100
Subject: [PATCH 1/1] Avoid duplicate key check in destructuring

Refers to CLJ-763
---
 src/clj/clojure/core.clj |    4 ++--
 1 files changed, 2 insertions(+), 2 deletions(-)

diff --git a/src/clj/clojure/core.clj b/src/clj/clojure/core.clj
index 4a6f776..4d5b44e 100644
--- a/src/clj/clojure/core.clj
+++ b/src/clj/clojure/core.clj
@@ -3864,7 +3864,7 @@
                        (let [gmap (or (:as b) (gensym "map__"))
                              defaults (:or b)]
                          (loop [ret (-> bvec (conj gmap) (conj v)
-                                        (conj gmap) (conj `(if (seq? ~gmap) (apply hash-map ~gmap) ~gmap)))
+                                        (conj gmap) (conj `(if (seq? ~gmap) (into {} (map vec (partition 2 ~gmap))) ~gmap)))
                                 bes (reduce1
                                      (fn [bes entry]
                                        (reduce1 #(assoc %1 %2 ((val entry) %2))
@@ -6328,4 +6328,4 @@
 (defn realized?
   "Returns true if a value has been produced for a promise, delay, future or lazy sequence."
   {:added "1.3"}
-  [^clojure.lang.IPending x] (.isRealized x))
\ No newline at end of file
+  [^clojure.lang.IPending x] (.isRealized x))
-- 
1.7.1

